<h1>{{post.seriesTitle}}</h1>
<h2>{{post.title}}</h2>
<div class="byAndDate">
	<small>by Egill Antonsson<br>
		published on {{publishedDateToString}}<br>
	</small>
	<small *ngIf="hasUpdatedDate">
		updated on {{updatedDateToString}}
	</small>
</div>

<h2>Using Unity (.NET)</h2>
<p>
	I will use <a href="https://unity.com">Unity</a> and the <i>Test Framework</i> package (a Unity integration of the <a href="https://nunit.org">NUnit</a> framework). The whole project is on <a href="https://github.com/EgillAntonsson/tdd-avatar-health-in-unity">GitHub</a> (including the Unity and package versions). Another C# .NET and Test Runner could be used for implementing the domain logic, but I choose Unity because I'm an experienced Unity developer and could effortlessly add the graphic visuals afterwards (but I might stop this blog series without visuals and instead blog about something else).
</p>

<h2>Setup</h2>
<p>
	I create a new Unity project and the update <i>Test Framework</i> package to latest version. The package <a href="https://docs.unity3d.com/Packages/com.unity.test-framework@1.1/manual/index.html">docs</a> detail how to setup tests for a project.
</p>
<p>
	My project structure starts very simple
</p>
<ul class="list inline">
	<li>The test code is in <i>Scripts/Tests/EditMode/ClassName]Test.cs</i></li>
	<li>The production code is in <i>Scripts/Runtime/[ClassName].cs</i></li>
</ul>
<p>
	As the folder structure implies I'm doing <i>EditMode</i> tests for the production <i>Runtime</i> code. <i>EditMode</i> test have access to both
</p>
<ul class="list inline">
	<li>the <i>Editor</i> code (e.g. to be able to test production code based on Unity editor code)</li>
	<li>the <i>Runtime</i> code (of the targeted platforms, e.g. iOS).</li>
</ul>
<p>
	My main reasons to prefer <i>EditMode</i> over <i>PlayMode</i> tests for <i>Runtime</i> code is that they run faster (as it has no runtime startup cost). Also unit testing the domain logic should not need the <i>PlayMode</i> features i.e. the tests should not need to run as <a href="https://docs.unity3d.com/Manual/Coroutines.html">Coroutine</a> to wait or step through frames. This in line with that good unit tests should run quickly (see the <i>What is a good Unit Test</i> section in <a href="./blog/tdd-health/part1">Part 1</a>). The doc <a href="https://docs.unity3d.com/Packages/com.unity.test-framework@1.1/manual/edit-mode-vs-play-mode-tests.html">EditMode vs. PlayMode tests</a> explains the difference further.
</p>

<div [innerHTML]="requirements"></div>

<h2>Health Points starting value</h2>
<h3><span class="redFail">RED (does not compile)</span></h3>
<div [innerHTML]="redDoesNotCompileStartingValue()"></div>
<pre><code [highlight]="codeTestRedDoesNotCompileStartingValue()"></code></pre>
<div [innerHTML]="redAfterDoesNotCompileStartingValue()"></div>

<h3><span class="redFail">RED (test fails)</span></h3>
<div [innerHTML]="redStartingValue1()"></div>
<pre><code [highlight]="codeTestRedStartingValue()"></code></pre>
<div [innerHTML]="redStartingValueImg()"></div>
<div [innerHTML]="redStartingValue2()"></div>

<h3><span class="greenPass">GREEN</span></h3>
<div [innerHTML]="greenStartingValue()"></div>
<pre><code [highlight]="codeImplGreenStartingValue()"></code></pre>

<h3><span class="greenRefactor">REFACTOR</span></h3>
<div [innerHTML]="greenStartingValue1()"></div>
<div [innerHTML]="greenStartingValue2()"></div>
<pre><code [highlight]="codeTestRefactorStartingValue()"></code></pre>

<div [innerHTML]="greenStartingValue3()"></div>
<pre><code [highlight]="codeImplRefactorStartingValue()"></code></pre>

<h2>Handle invalid <span class="code">StartingPoints</span> values</h2>
<div [innerHTML]="invalidStartingPoints()"></div>

<h3><span class="redFail">RED</span></h3>
<div [innerHTML]="redInvalidStartingPoints1()"></div>
<pre><code [highlight]="codeTestRedInvalidStartingPoints()"></code></pre>
<div [innerHTML]="redInvalidStartingPoints2()"></div>
<div [innerHTML]="testNamingConvention()"></div>

<h3><span class="greenPass">GREEN</span></h3>
<pre><code [highlight]="codeImplGreenInvalidStartingPoints()"></code></pre>
<div [innerHTML]="greenInvalidStartingPoints()"></div>

<h3><span class="greenRefactor">REFACTOR</span></h3>
<pre><code [highlight]="codeImplRefactorInvalidStartingPoints()"></code></pre>
<div [innerHTML]="refactorInvalidStartingPoints()"></div>

<h2>Testing more values for verification</h2>
<div [innerHTML]="testingMoreValues()"></div>

<h3><span class="greenRefactor">REFACTOR</span></h3>
<div [innerHTML]="parameterizedRefactor1()"></div>
<div [innerHTML]="parameterizedRefactor2()"></div>
<pre><code [highlight]="codeTestRefactorParameterized()"></code></pre>
<div [innerHTML]="parameterizedRefactor3()"></div>
<div [innerHTML]="parameterizedRefactorImg()"></div>
