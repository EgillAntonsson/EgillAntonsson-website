<h1>{{post.seriesTitle}}</h1>
<h2>{{post.title}}</h2>
<small>by Egill Antonsson, published on {{post.dateYear}} {{post.dateMonth}} {{post.dateDay}}</small>

<p>
	Let's look closer to the <i>definition and start state</i> from the user perspective:
</p>
<ul>
	<li>The Life Gauge measures Link's current amount of health</li>
	<li>Health is visually represented in the form of Hearts, and they are in fractions of four</li>
	<li>The Life Gauge starts with 3 Hearts</li>
</ul>
<p>
	Let's filter and transform this into a functional requirement focused only on the domain logic (as visual representation will be done later):
</p>
<ul>
	<li>Avatar Health starts with 12 Health Points (equals to visual representation of 3 Hearts * 4 Fractions)</li>
</ul>
<p>
</p>

<h2>Health Points starting value</h2>

<h3><span class="redFail">RED</span></h3>
<p>
	I define the test class and the first test.<br>
	I start focusing on <code>Health</code> class implementation<br>
	(which in the end will likely be associated with an <code>Avatar</code> class).<br>
	The test is failing as the code does not even compile.
</p>
<pre><code [highlight]="test_1_Red"></code></pre>

<h3><span class="greenPass">GREEN</span></h3>
<p>Let's make the test pass with a simple implementation.
</p>
<pre><code [highlight]="impl_1_Green"></code></pre>

<h3><span class="greenRefactor">REFACTOR</span></h3>

<p>Now it comes to mind that from a game design perspective,<br>
	it is good to be able to tweak the starting health points for game balancing,<br>
	thus I refactor the value to be passed as parameter into the constructor.<br>
	<span class="outOfScope">An advanced system would have accessible game balancing config<br>
	that is well integrated into the code base,<br>
	that would then use <code>Health</code> class as designed (passing in value/s).<br>
	I might later implement a simplified version of game balancing config.</span><br>
	<br>
	I name the passed in parameter to <code>startingPoints</code>.<br>
	I also rename the property to <code>CurrentPoints</code> to further clarify the logic:<br>
	<i>starting points is passed into the constructor which sets the current points.</i><br>
	<br>
	I also encapsulate <code>CurrentPoints</code> with private setter,<br>
	as I want to <a href="https://medium.com/swlh/the-importance-of-code-encapsulation-ce19efbcfe57"> encapsulate the implementation</a> as much as possible.<br>
	The only exposure should be for the class interface, that the tests will drive,<br>
	that will gradually be established through the TDD cycles.
</p>
<pre><code [highlight]="code_1_Refactor"></code></pre>

<h2>Handle invalid <code>StartingPoints</code> values</h2>
<p>
	Now it comes to mind that invalid <code>StartingPoints</code> values can be passed in,<br>
	as our avatar should never start with less than 1 points,<br>
	(because otherwise Link would start up being dead :) )<br>
	Thus I'll throw exceptions when the value is invalid.<br>
	<span class="outOfScope">Invalid values should also be handled where they are defined<br>
	(in the previously mentioned game balancing config).<br></span>
</p>

<h3><span class="redFail">RED</span></h3>

<pre><code [highlight]="test_2_Red"></code></pre>

<p>
	I deem I can use existing <code>ArgumentOutOfRangeException</code> from <code>System</code><br>
	if I include an informative error message for my case.<br>
	<br>
	I chose the value 0 as it's on the edge of invalidation (as 1 is valid).
</p>

<h3><span class="greenPass">GREEN</span></h3>

<pre><code [highlight]="impl_2_Green"></code></pre>

<p>The implementation of the conditional '<code [highlight]="'if (startingPoint < 1)'"></code>'<br>
	is also the proper generic solution (at least for now), as it was easy to come up with.<br>
	<br>
	The message of the thrown exception would be (if value 0 was passed in):
	<span class="code">System.ArgumentOutOfRangeException : Value '0' is invalid, it should be higher than '0'<br>
		Parameter name: startingPoints</span><br>
	<br>
	<br>
	I feel that no refactoring is needed in this cycle,<br>
	as I did both <span class="greenPass">GREEN</span> and <span class="greenRefactor">REFACTOR</span> in one step,<br>
	for both the conditional and the thrown exception and its message,<br>
	and overall the code looks clean, so moving on.
</p>

<h2>Let's test a few more values</h2>

<p>As the implementation is very simple I am confident that it's the proper generic solution that works for any passed-in values.<br>
	But let's test a few more values to demonstrate how to do it clean and maintainable way.
</p>

<h3><span class="greenRefactor">REFACTOR</span></h3>

<p>Refactoring the tests to add test cases where the value is close to the valid/invalid edge,<br>
	using <a href="https://docs.nunit.org/articles/nunit/technical-notes/usage/Parameterized-Tests.html">Parameterized Tests</a> with inline <a href="https://docs.nunit.org/articles/nunit/writing-tests/attributes/testcase.html">Test Case attribute</a>.
</p>
<pre><code [highlight]="test_3_Green"></code></pre>

<p>
	This runs in total 4 test cases and Unity Test Runner looks like this (menu item <i>Window > General > Test Runner</i>):
</p>

<figure>
	<img src="../assets/images/blog/tdd/HealthTest-using-TestCase.PNG" alt="The family: Egill Antonsson, Soffía Rós Egilsdóttir, Jantra Phosri & Andri Reyr Ragnarsson" title="The family: Egill Antonsson, Soffía Rós Egilsdóttir, Jantra Phosri & Andri Reyr Ragnarsson" class="image">
	<figcaption>
		The family, from left to right:<br>
		Egill Antonsson, Soffía Rós Egilsdóttir, Jantra Phosri & Andri Reyr Ragnarsson
	</figcaption>
</figure>

<h2>Concluding this part</h2>

<p>This concludes the first requirement and this part.<br>
	I aim to continue with the requirements and the implementation in later blog posts.
</p>
